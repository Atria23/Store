import{r,j as e,a as R}from"./app-BPrLCREs.js";function O({auth:_}){var v,k,S,P;const[h,T]=r.useState(""),[s,u]=r.useState(null),[t,p]=r.useState(null),[c,d]=r.useState(!1),[o,i]=r.useState(""),[N,g]=r.useState(!1),[j,w]=r.useState(""),[f,D]=r.useState(!1),[y,L]=r.useState(!1),b=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),x=_.user.balance,l=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a||0),B=async a=>{a.preventDefault(),d(!0),i(""),u(null);try{const n=await fetch(route("pln.pasca.inquiry"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":b},body:JSON.stringify({customer_no:h})}),m=await n.json();if(!n.ok)throw new Error(m.message||"Gagal melakukan pengecekan tagihan.");u(m)}catch(n){i(n.message)}finally{d(!1)}},A=()=>{if(x<s.selling_price){i("Saldo tidak mencukupi untuk melakukan transaksi.");return}i(""),w(""),g(!0)},z=async a=>{if(a.preventDefault(),!j){i("Silakan masukkan password untuk melanjutkan.");return}d(!0),i("");try{const n=await fetch("/auth/verify-password",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":b},body:JSON.stringify({password:j})}),m=await n.json();if(!n.ok||!m.success)throw new Error("Password yang Anda masukkan salah.");const C=await fetch(route("pln.pasca.payment"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":b},body:JSON.stringify({customer_no:s.customer_no})}),M=await C.json();if(!C.ok)throw new Error(M.message||"Gagal melakukan pembayaran.");p(M.data),u(null),g(!1)}catch(n){i(n.message)}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"PLN Pascabayar"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] bg-gray-50 flex flex-col min-h-screen",children:[e.jsxs("header",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 flex items-center space-x-4 px-4 py-3 bg-main text-white shadow-md",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-semibold text-lg",children:"PLN Pascabayar"})]}),e.jsxs("main",{className:"w-full pt-20 pb-40 px-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg shadow-sm border",children:[e.jsxs("p",{className:"font-semibold text-sm text-gray-700 flex items-center space-x-2",children:[e.jsxs("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 14a3 3 0 0 1 3-3h4a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-4a3 3 0 0 1-3-3Zm3-1a1 1 0 1 0 0 2h4v-2h-4Z"}),e.jsx("path",{d:"M12.293 3.293a1 1 0 0 1 1.414 0L16.414 6h-2.828l-1.293-1.293a1 1 0 0 1 0-1.414ZM12.414 6 9.707 3.293a1 1 0 0 0-1.414 0L5.586 6h6.828ZM4.586 7l-.056.055A2 2 0 0 0 3 9v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2h-4a5 5 0 0 1 0-10h4a2 2 0 0 0-1.53-1.945L17.414 7H4.586Z"})]}),e.jsx("span",{children:"Saldo Anda"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-bold text-sm",children:y?l(x):"••••••••"}),e.jsx("button",{onClick:()=>L(!y),className:"text-blue-600",children:y?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),e.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"}),e.jsx("path",{d:"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"})]})})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[t?t.status==="Sukses"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mt-2",children:"Pembayaran Berhasil"}),e.jsx("p",{className:"text-sm text-gray-500",children:t.message})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Pembayaran"}),e.jsx("p",{className:"text-3xl font-bold text-main",children:l(t.selling_price)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("h4",{className:"font-semibold text-md text-gray-800 pb-1 border-b",children:"Detail Pelanggan"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nama"}),e.jsx("span",{className:"font-medium text-right",children:t.customer_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"ID Pelanggan"}),e.jsx("span",{className:"font-medium",children:t.customer_no})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tarif/Daya"}),e.jsx("span",{className:"font-medium",children:`${t.desc.tarif} / ${t.desc.daya}VA`})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("h4",{className:"font-semibold text-md text-gray-800 pb-1 border-b",children:"Rincian Tagihan"}),t.desc.detail.map((a,n)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Periode"}),e.jsx("span",{className:"font-medium",children:a.periode})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Meter Awal"}),e.jsx("span",{className:"font-medium",children:a.meter_awal})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Meter Akhir"}),e.jsx("span",{className:"font-medium",children:a.meter_akhir})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tagihan Pokok"}),e.jsx("span",{className:"font-medium",children:l(a.nilai_tagihan)})]}),Number(a.denda)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Denda"}),e.jsx("span",{className:"font-medium text-red-600",children:l(a.denda)})]})]},n))]}),e.jsxs("p",{className:"text-xs text-gray-500 bg-gray-100 p-2 rounded-md text-center",children:["SN: ",t.sn]}),e.jsx("button",{onClick:()=>p(null),className:"w-full py-2 px-4 bg-main text-white font-semibold rounded-lg hover:bg-blue-700",children:"Transaksi Lagi"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mt-2",children:"Pembayaran Gagal"}),e.jsx("p",{className:"text-sm text-red-700 bg-red-50 p-3 mt-2 rounded-lg",children:t.message})]}),e.jsxs("div",{className:"space-y-2 text-sm border-t pt-4",children:[e.jsx("h4",{className:"font-semibold text-md text-gray-800 pb-1",children:"Detail Transaksi Gagal"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"ID Pelanggan"}),e.jsx("span",{className:"font-medium",children:t.customer_no})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nama"}),e.jsx("span",{className:"font-medium text-right",children:t.customer_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Jumlah"}),e.jsx("span",{className:"font-medium",children:l(t.selling_price)})]})]}),e.jsx("button",{onClick:()=>p(null),className:"w-full py-2 px-4 bg-main text-white font-semibold rounded-lg hover:bg-blue-700",children:"Coba Lagi"})]}):s?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"w-full font-semibold text-md text-center text-gray-800",children:"Detail Tagihan"}),e.jsx("div",{className:"w-full h-px bg-gray-200"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nomor Pelanggan"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.customer_no})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nama Pelanggan"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.customer_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tarif/Daya"}),e.jsx("span",{className:"font-medium text-gray-900",children:`${s.desc.tarif} / ${s.desc.daya}VA`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Periode Tagihan"}),e.jsx("span",{className:"font-medium text-gray-900",children:(v=s.desc.detail[0])==null?void 0:v.periode})]}),e.jsx("div",{className:"w-full h-px bg-gray-100 my-1"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nilai Tagihan"}),e.jsx("span",{className:"font-medium text-gray-900",children:l((k=s.desc.detail[0])==null?void 0:k.nilai_tagihan)})]}),Number((S=s.desc.detail[0])==null?void 0:S.denda)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Denda"}),e.jsx("span",{className:"font-medium text-red-600",children:l((P=s.desc.detail[0])==null?void 0:P.denda)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Biaya Admin"}),e.jsx("span",{className:"font-medium text-gray-900",children:l(s.admin)})]})]}),e.jsx("div",{className:"w-full h-px bg-gray-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Total Pembayaran"}),e.jsx("span",{className:"font-bold text-xl text-blue-600",children:l(s.selling_price)})]})]}):e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customer_no",className:"block text-sm font-medium text-gray-700 mb-1",children:"ID Pelanggan PLN"}),e.jsx("input",{id:"customer_no",type:"number",value:h,onChange:a=>T(a.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:c,required:!0,placeholder:"Masukkan ID Pelanggan"})]}),e.jsx("button",{type:"submit",disabled:c||!h,className:"w-full py-2 px-4 bg-main text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:c?"Mengecek...":"Lanjutkan"})]}),o&&!N&&e.jsx("p",{className:"text-red-500 text-xs text-center pt-2",children:o})]})]}),s&&!t&&e.jsx("footer",{className:"fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-[500px] p-4 bg-white shadow-[0_-2px_5px_rgba(0,0,0,0.1)] rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Pembayaran"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:l(s.selling_price)})]}),e.jsx("button",{onClick:A,disabled:x<s.selling_price,className:"px-6 py-2 rounded-lg font-semibold text-white bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:x<s.selling_price?"Saldo Kurang":"Bayar Sekarang"})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-sm space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-center",children:"Konfirmasi Pembayaran"}),e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:f?"text":"password",value:j,onChange:a=>w(a.target.value),className:"w-full border p-2 pr-10 rounded",placeholder:"Masukkan password Anda",autoFocus:!0}),e.jsx("button",{type:"button",onClick:()=>D(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:f?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),e.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"}),e.jsx("path",{d:"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"})]})})]}),o&&e.jsx("p",{className:"text-red-500 text-xs text-center pt-2",children:o}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Batal"}),e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm font-medium text-white bg-main hover:bg-blue-700 rounded-lg disabled:bg-gray-400",children:c?"Memproses...":"Konfirmasi"})]})]})]})})]})]})}export{O as default};
