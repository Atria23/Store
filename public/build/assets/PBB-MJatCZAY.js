import{r as d,j as e,a as pe,y as Z}from"./app-C3d0GIB6.js";function be({auth:ee,products:ae}){var U,H,V,X,Q,Y;const[B,K]=d.useState(""),[o,z]=d.useState(null),[s,w]=d.useState(null),[j,f]=d.useState(null),[C,$]=d.useState(""),[l,v]=d.useState(null),[y,k]=d.useState(null),[n,I]=d.useState(!1),[F,G]=d.useState(""),[p,u]=d.useState(!1),[r,c]=d.useState(null),[se,O]=d.useState(!1),[_,R]=d.useState(""),[L,te]=d.useState(!1),P=(U=document.head.querySelector('meta[name="csrf-token"]'))==null?void 0:U.content,E=ee.user.balance,q=d.useRef(null),[le,ne]=d.useState(0),re=d.useMemo(()=>({"00":"Transaksi Sukses","01":"Timeout","02":"Transaksi Gagal","03":"Transaksi Pending",40:"Payload Error",50:"Transaksi Tidak Ditemukan",51:"Nomor Tujuan Diblokir",52:"Prefix Tidak Sesuai Operator",53:"Produk Tidak Tersedia",54:"Nomor Tujuan Salah",55:"Produk Gangguan",57:"Jumlah Digit Tidak Sesuai",58:"Sedang Perbaikan",59:"Tujuan di Luar Wilayah",60:"Tagihan Belum Tersedia",62:"Produk Mengalami Gangguan",63:"Tidak Support Transaksi Multi",65:"Limit Transaksi Multi",66:"Sedang Perbaikan Sistem",68:"Stok Habis",71:"Produk Tidak Stabil",72:"Unreg Paket Dulu",73:"Kwh Melebihi Batas",74:"Transaksi Refund",80:"Akun Diblokir Penyedia Layanan",82:"Akun Belum Terverifikasi",84:"Nominal Tidak Valid",85:"Limitasi Transaksi",86:"Limitasi Pengecekan PLN",PRODUCT_NOT_ACTIVE:"Produk PBB tidak aktif.",API_CONNECTION_FAILED:"Gagal terhubung ke server penyedia layanan PBB.",UNKNOWN_ERROR:"Terjadi kesalahan tidak dikenal saat inquiry PBB."}),[]),g=a=>re[a]||null;d.useEffect(()=>{q.current&&ne(q.current.offsetHeight)},[o,s,j,l]),d.useEffect(()=>{r&&c(null)},[B,_,o,F,C,n]);const i=a=>{const t=parseFloat(a);return isNaN(t)?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(0):new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t)},T=d.useMemo(()=>!l||!l.successful?0:l.successful.reduce((a,t)=>a+(t.selling_price??0),0),[l]),J=d.useMemo(()=>!l||!l.successful?0:l.successful.reduce((a,t)=>a+(t.diskon||0),0),[l]),ie=async a=>{if(a.preventDefault(),!o){c({message:"Silakan pilih produk terlebih dahulu.",rc:null});return}if(!o.seller_product_status){c({message:"Produk ini sedang mengalami gangguan. Silakan pilih produk lain.",rc:"PRODUCT_NOT_ACTIVE"});return}u(!0),c(null),w(null),f(null),v(null),k(null);try{const t=await fetch(route("pascapbb.inquiry"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":P},body:JSON.stringify({customer_no:B,buyer_sku_code:o.buyer_sku_code})}),m=await t.json();if(!t.ok){c({message:m.message||"Gagal melakukan pengecekan tagihan.",rc:m.rc||null}),u(!1);return}w(m)}catch(t){c({message:t.message||"Terjadi kesalahan jaringan atau tak terduga.",rc:null})}finally{u(!1)}},ce=async a=>{if(a.preventDefault(),!o){c({message:"Silakan pilih produk PBB terlebih dahulu.",rc:null});return}if(!o.seller_product_status){c({message:"Produk ini sedang mengalami gangguan. Silakan pilih produk lain.",rc:"PRODUCT_NOT_ACTIVE"});return}u(!0),c(null),w(null),f(null),v(null),k(null);const t=C.split(/[\n,;\s]+/).map(m=>m.trim()).filter(m=>m.length>=4);if(t.length===0){c({message:"Masukkan setidaknya satu ID Pelanggan (NOP) yang valid.",rc:null}),u(!1);return}try{const m=await fetch(route("pascapbb.bulk-inquiry"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":P},body:JSON.stringify({customer_nos:t,buyer_sku_code:o.buyer_sku_code})}),x=await m.json();if(!m.ok){c({message:x.message||"Gagal melakukan pengecekan tagihan massal.",rc:x.rc||null}),u(!1);return}v(x)}catch(m){c({message:m.message||"Terjadi kesalahan jaringan atau tak terduga saat cek massal.",rc:null})}finally{u(!1)}},de=()=>{const a=n?T:s==null?void 0:s.selling_price;if(E<a){c({message:"Saldo Anda tidak mencukupi untuk melakukan transaksi.",rc:null});return}c(null),R(""),O(!0)},oe=async a=>{if(a.preventDefault(),!_){c({message:"Silakan masukkan password untuk melanjutkan.",rc:null});return}if(!s&&!n||n&&(!l||l.successful.length===0)){c({message:"Tidak ada tagihan yang siap dibayar.",rc:null});return}u(!0),c(null),f(null),k(null);try{const t=await fetch("/auth/verify-password",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":P},body:JSON.stringify({password:_})}),m=await t.json();if(!t.ok||!m.success){c({message:m.message||"Password yang Anda masukkan salah.",rc:m.rc||null}),u(!1);return}let x;if(n){const M=l.successful.map(A=>A.customer_no);x=await fetch(route("pascapbb.bulk-payment"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":P},body:JSON.stringify({customer_nos_to_pay:M})})}else x=await fetch(route("pascapbb.payment"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":P},body:JSON.stringify({customer_no:s.customer_no})});const h=await x.json();if(!x.ok){c({message:h.message||"Gagal melakukan pembayaran.",rc:h.rc||null}),n?k(h):f(h),u(!1);return}n?k(h):f(h),w(null),v(null),O(!1),R(""),Z.reload({only:["auth"]})}catch(t){c({message:t.message||"Terjadi kesalahan jaringan atau tak terduga saat pembayaran.",rc:null})}finally{u(!1)}},b=j||y&&y.results&&y.results.length>0,N=s||l&&(l.successful.length>0||l.failed.length>0),me=!o&&!N&&!b,ue=o&&!n&&!N&&!b,xe=o&&n&&!N&&!b,W=ae.filter(a=>a.product_name.toLowerCase().includes(F.toLowerCase())),D=()=>{z(null),K(""),$(""),w(null),v(null),c(null),f(null),k(null),G(""),O(!1),R(""),I(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{title:"PBB Pascabayar"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] min-h-screen bg-gray-50 flex flex-col",children:[e.jsxs("header",{ref:q,className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 bg-white shadow-lg",children:[e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 justify-start items-center px-4 py-3 bg-main",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>b||N||o?D():window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-semibold text-white text-lg",children:"Tagihan PBB"})]}),me&&e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs("div",{className:"w-full h-9 flex flex-row mx-auto items-center justify-center pr-2 py-2 rounded-lg bg-neutral-100 border-2 border-gray-200",children:[e.jsx("input",{type:"text",className:"bg-transparent border-none flex-grow focus:ring-0 focus:outline-none placeholder-gray-400 px-3",placeholder:"Cari wilayah PBB (misal: Kota Bandung)...",value:F,onChange:a=>G(a.target.value)}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.3",className:"w-5 h-5 text-main",children:e.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14A4.5 4.5 0 1 1 14 9.5 4.505 4.505 0 0 1 9.5 14z"})})]})}),o&&!N&&!b&&e.jsxs("div",{className:"p-4 space-y-3 border-t",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Produk Pilihan:"}),e.jsx("p",{className:"font-bold text-main text-right",children:o.product_name})]}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx("button",{onClick:()=>I(!1),className:`w-1/2 py-2 text-sm font-semibold rounded-lg ${n?"bg-gray-200 text-gray-700":"bg-main text-white"}`,children:"Transaksi Satuan"}),e.jsx("button",{onClick:()=>I(!0),className:`w-1/2 py-2 text-sm font-semibold rounded-lg ${n?"bg-main text-white":"bg-gray-200 text-gray-700"}`,children:"Transaksi Massal"})]}),ue&&e.jsxs("form",{onSubmit:ie,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customer_no_input",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor Objek Pajak (NOP)"}),e.jsx("input",{id:"customer_no_input",type:"text",inputMode:"numeric",pattern:"[0-9.-]*",value:B,onChange:a=>{const t=a.target.value;/^[0-9.-]*$/.test(t)&&K(t)},onWheel:a=>a.target.blur(),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:p||!o.seller_product_status,required:!0,placeholder:"Masukkan NOP"})]}),r&&r.message&&e.jsxs("p",{className:"text-red-500 text-xs text-center pt-2",children:[g(r.rc)||r.message,!g(r.rc)&&r.rc?` (RC: ${r.rc})`:""," "]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:D,className:"w-full bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-300",children:"Pilih Ulang"}),e.jsx("button",{type:"submit",disabled:p||!B||!o.seller_product_status,className:"w-full bg-main text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:p?"Mengecek...":"Cek Tagihan"})]})]}),xe&&e.jsxs("form",{onSubmit:ce,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customer_nos_bulk",className:"block text-sm font-medium text-gray-700 mb-1",children:"NOP (Nomor Objek Pajak) (Pisahkan dengan koma, spasi, atau baris baru)"}),e.jsx("textarea",{id:"customer_nos_bulk",value:C,onChange:a=>$(a.target.value),rows:"5",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:p||!o.seller_product_status,required:!0,placeholder:`Contoh:
32.09.010.001.001-0001.0
32.09.010.001.001-0002.0, 32.09.010.001.001-0003.0`})]}),r&&r.message&&e.jsxs("p",{className:"text-red-500 text-xs text-center pt-2",children:[g(r.rc)||r.message,!g(r.rc)&&r.rc?` (RC: ${r.rc})`:""," "]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:D,className:"w-full bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-300",children:"Pilih Ulang"}),e.jsx("button",{type:"submit",disabled:p||!C.trim()||!o.seller_product_status,className:"w-full bg-main text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:p?"Mengecek Massal...":"Cek Tagihan Massal"})]})]})]})]}),e.jsx("main",{style:{paddingTop:`${le}px`},className:"w-full pt-4 pb-40 px-4 space-y-4 flex-grow",children:e.jsx("div",{className:"mt-4 bg-white p-4 rounded-lg shadow-sm border",children:b?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mt-2",children:"Pembayaran Selesai"}),e.jsx("p",{className:"text-sm text-gray-500",children:n?"Pembayaran Tagihan PBB Massal":"Pembayaran Tagihan PBB Anda berhasil."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Pembayaran Berhasil"}),e.jsx("p",{className:"text-3xl font-bold text-main",children:i(n?y.total_paid_amount:j.selling_price)})]}),n&&y.results.filter(a=>a.status!=="Sukses").length>0&&e.jsxs("div",{className:"text-center text-sm text-red-600 font-semibold bg-red-50 p-2 rounded-lg",children:["Ada ",y.results.filter(a=>a.status!=="Sukses").length," transaksi yang gagal. Saldo akan dikembalikan."]}),n&&J>0&&e.jsxs("div",{className:"text-center text-sm text-green-600 font-semibold bg-green-50 p-2 rounded-lg",children:["Total diskon: ",i(J),"!"]}),j&&j.status!=="Sukses"&&e.jsx("div",{className:"text-sm text-red-700 bg-red-50 p-3 mt-2 rounded-lg",children:j.message||"Terjadi kesalahan saat memproses pembayaran Anda."}),e.jsx("button",{onClick:()=>Z.visit(route("postpaid.history.index")),className:"w-full py-2 px-4 border border-main text-main font-semibold rounded-lg hover:bg-blue-50 transition-colors",children:"Riwayat Transaksi"}),e.jsx("button",{onClick:D,className:"w-full py-2 px-4 bg-main text-white font-semibold rounded-lg hover:bg-blue-700",children:"Lakukan Transaksi Lain"})]}):N?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"w-full font-semibold text-md text-center text-gray-800 pb-3 border-b",children:n?"Ringkasan Pengecekan Tagihan Massal":"Detail Tagihan"}),s&&!n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:"Detail Wajib Pajak"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nama Wajib Pajak"}),e.jsx("span",{className:"font-medium text-gray-900 text-right",children:((H=s.desc)==null?void 0:H.nama_wajib_pajak)||s.customer_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"NOP"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.customer_no})]}),((V=s.desc)==null?void 0:V.objek_pajak)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Objek Pajak"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.desc.objek_pajak})]}),((X=s.desc)==null?void 0:X.alamat_objek_pajak)&&s.desc.alamat_objek_pajak!=="-"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Alamat Objek Pajak"}),e.jsx("span",{className:"font-medium text-right",children:s.desc.alamat_objek_pajak})]}),s.jumlah_lembar_tagihan>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Jumlah Tagihan"}),e.jsxs("span",{className:"font-medium",children:[s.jumlah_lembar_tagihan," Tahun"]})]}),((Q=s.desc)==null?void 0:Q.jatuh_tempo)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Jatuh Tempo Terakhir"}),e.jsx("span",{className:"font-medium",children:s.desc.jatuh_tempo})]})]}),((Y=s.desc)==null?void 0:Y.detail)&&s.desc.detail.length>0&&e.jsxs("div",{className:"space-y-2 text-sm border-t pt-2",children:[e.jsx("h4",{className:"font-semibold text-md text-gray-800 pb-1",children:"Rincian per Tahun Pajak"}),s.desc.detail.map((a,t)=>e.jsxs("div",{className:"border-b pb-2 mb-2 last:border-b-0 last:pb-0",children:[e.jsxs("p",{className:"font-medium text-gray-700",children:["Tahun Pajak: ",a.tahun_pajak]}),e.jsxs("div",{className:"flex justify-between pl-2",children:[e.jsx("span",{className:"text-gray-500",children:"Nilai PBB Pokok"}),e.jsx("span",{className:"font-medium",children:i(a.nilai_pbb)})]}),parseFloat(a.denda_pbb)>0&&e.jsxs("div",{className:"flex justify-between pl-2",children:[e.jsx("span",{className:"text-gray-500",children:"Denda PBB"}),e.jsx("span",{className:"font-medium text-red-600",children:i(a.denda_pbb)})]}),e.jsxs("div",{className:"flex justify-between pl-2",children:[e.jsx("span",{className:"text-gray-500",children:"Total Tagihan Tahun Ini"}),e.jsx("span",{className:"font-medium",children:i(a.total_tagihan_per_tahun)})]})]},t))]}),e.jsxs("div",{className:"space-y-2 text-sm border-t pt-2",children:[e.jsx("h4",{className:"font-semibold text-md text-gray-800 pb-1",children:"Ringkasan Pembayaran"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total PBB Pokok"}),e.jsx("span",{className:"font-medium text-gray-900",children:i(s.price)})]}),parseFloat(s.denda)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Denda PBB"}),e.jsx("span",{className:"font-medium text-red-600",children:i(s.denda)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Biaya Admin"}),e.jsx("span",{className:"font-medium text-gray-900",children:i(s.admin)})]}),parseFloat(s.diskon)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Diskon"}),e.jsxs("span",{className:"font-medium text-green-600",children:["- ",i(s.diskon)]})]})]}),e.jsx("div",{className:"w-full h-px bg-gray-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Total Pembayaran Akhir"}),e.jsx("span",{className:"font-bold text-xl text-blue-600",children:i(s.selling_price)})]})]}),l&&n&&e.jsxs("div",{className:"space-y-4",children:[l.successful.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"font-semibold text-gray-800",children:["Tagihan Berhasil Ditemukan (",l.successful.length,")"]}),l.successful.map((a,t)=>{var x,h,M,A;const m=a.admin;return e.jsxs("div",{className:"border border-blue-200 bg-blue-50 p-3 rounded-lg space-y-1 text-sm",children:[e.jsx("p",{className:"font-semibold text-main text-base mb-2",children:a.product_name}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nama Wajib Pajak"}),e.jsx("span",{className:"font-medium text-gray-900 text-right",children:((x=a.desc)==null?void 0:x.nama_wajib_pajak)||a.customer_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"NOP"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.customer_no})]}),((h=a.desc)==null?void 0:h.objek_pajak)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Objek Pajak"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.desc.objek_pajak})]}),((M=a.desc)==null?void 0:M.alamat_objek_pajak)&&a.desc.alamat_objek_pajak!=="-"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Alamat Objek Pajak"}),e.jsx("span",{className:"font-medium text-gray-900 text-right",children:a.desc.alamat_objek_pajak})]}),((A=a.desc)==null?void 0:A.detail)&&a.desc.detail.length>0&&e.jsxs("div",{className:"space-y-1 text-xs border-t pt-1 mt-1",children:[e.jsx("h5",{className:"font-semibold text-gray-700",children:"Rincian per Tahun Pajak"}),a.desc.detail.map((S,he)=>e.jsxs("div",{className:"pb-1 mb-1 last:border-b-0 last:pb-0",children:[e.jsxs("p",{className:"font-medium text-gray-600",children:["Tahun Pajak: ",S.tahun_pajak]}),e.jsxs("div",{className:"flex justify-between pl-2",children:[e.jsx("span",{className:"text-gray-500",children:"Nilai PBB Pokok"}),e.jsx("span",{className:"font-medium",children:i(S.nilai_pbb)})]}),parseFloat(S.denda_pbb)>0&&e.jsxs("div",{className:"flex justify-between pl-2",children:[e.jsx("span",{className:"text-gray-500",children:"Denda PBB"}),e.jsx("span",{className:"font-medium text-red-600",children:i(S.denda_pbb)})]}),e.jsxs("div",{className:"flex justify-between pl-2",children:[e.jsx("span",{className:"text-gray-500",children:"Total Tagihan Tahun Ini"}),e.jsx("span",{className:"font-medium",children:i(S.total_tagihan_per_tahun)})]})]},he))]}),e.jsxs("div",{className:"space-y-1 text-sm border-t pt-1 mt-1",children:[e.jsx("h5",{className:"font-semibold text-gray-800",children:"Ringkasan Pembayaran"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total PBB Pokok"}),e.jsx("span",{className:"font-medium text-gray-900",children:i(a.price)})]}),parseFloat(a.denda)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Denda PBB"}),e.jsx("span",{className:"font-medium text-red-600",children:i(a.denda)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Biaya Admin"}),e.jsx("span",{className:"font-medium text-gray-900",children:i(m)})]}),parseFloat(a.diskon)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Diskon"}),e.jsxs("span",{className:"font-medium text-green-600",children:["- ",i(a.diskon)]})]}),e.jsx("div",{className:"w-full h-px bg-gray-200 mt-2"}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Total Bayar"}),e.jsx("span",{className:"font-bold text-lg text-main",children:i(a.selling_price)})]})]})]},t)})]}),l.failed.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"font-semibold text-red-700 mt-4",children:["Tagihan Gagal Ditemukan (",l.failed.length,")"]}),l.failed.map((a,t)=>e.jsxs("div",{className:"border border-red-300 bg-red-50 p-3 rounded-lg space-y-1 text-sm",children:[e.jsx("p",{className:"font-semibold text-red-800 text-base mb-2",children:a.product_name||"Produk Tidak Diketahui"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"NOP"}),e.jsx("span",{className:"font-bold text-red-800",children:a.customer_no})]}),e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[g(a.rc)||a.message,!g(a.rc)&&a.rc?` (RC: ${a.rc})`:""]})]},t))]}),l.successful.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full h-px bg-gray-200 mt-4"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Total Pembayaran Massal"}),e.jsx("span",{className:"font-bold text-xl text-main",children:i(T)})]})]})]})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:W.length>0?W.map(a=>{const t=!Number(a.seller_product_status),m=o&&o.id===a.id;return e.jsxs("div",{onClick:()=>!t&&z(a),className:`flex flex-col justify-between p-3 border rounded-lg shadow-sm transition-all duration-200 ${t?"bg-gray-200 opacity-70 cursor-not-allowed":"bg-white cursor-pointer hover:shadow-lg"} ${m?"border-main ring-2 ring-blue-500":"border-gray-200"}`,children:[e.jsx("h3",{className:"text-utama text-xs font-semibold line-clamp-2 mb-2",children:a.product_name}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("p",{className:"text-gray-500 text-xs",children:"Admin"}),e.jsx("p",{className:"text-main text-sm font-bold",children:i(a.calculated_admin)}),t&&e.jsx("p",{className:"text-xs text-red-500 mt-1 font-medium",children:"Gangguan"})]})]},a.id)}):e.jsx("p",{className:"col-span-2 text-center text-gray-500 pt-4",children:"Produk tidak ditemukan."})})})}),(s&&!n||l&&n&&l.successful.length>0)&&!b&&e.jsx("footer",{className:"fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-[500px] p-4 bg-white shadow-[0_-2px_5px_rgba(0,0,0,0.1)] rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Pembayaran Akhir"}),e.jsx("p",{className:"text-xl font-bold text-main",children:i(n?T:s.selling_price)})]}),e.jsx("button",{onClick:de,disabled:E<(n?T:s.selling_price),className:"px-6 py-2 rounded-lg font-semibold text-white bg-main hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:E<(n?T:s.selling_price)?"Saldo Kurang":"Bayar Sekarang"})]})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-sm space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-center",children:"Konfirmasi Pembayaran"}),e.jsxs("form",{onSubmit:oe,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:L?"text":"password",value:_,onChange:a=>R(a.target.value),className:"w-full border p-2 pr-10 rounded",placeholder:"Masukkan password Anda",autoFocus:!0,required:!0}),e.jsx("button",{type:"button",onClick:()=>te(!L),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:L?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),e.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"}),e.jsx("path",{d:"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"})]})})]}),r&&r.message&&e.jsxs("p",{className:"text-red-500 text-xs text-center pt-2",children:[g(r.rc)||r.message,!g(r.rc)&&r.rc?` (RC: ${r.rc})`:""," "]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>O(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Batal"}),e.jsx("button",{type:"submit",disabled:p||!_,className:"px-4 py-2 text-sm font-medium text-white bg-main hover:bg-blue-700 rounded-lg disabled:bg-gray-400",children:p?"Memproses...":"Konfirmasi"})]})]})]})})]})]})}export{be as default};
