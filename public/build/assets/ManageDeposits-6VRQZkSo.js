import{r,W as $,j as e,a as E}from"./app-DqYPIc8z.js";const V=({deposits:L})=>{const[D,h]=r.useState(L),[i,S]=r.useState(""),[x,p]=r.useState(1),[d,I]=r.useState("desc"),[l,m]=r.useState({start:"",end:""}),[f,u]=r.useState(!1),{data:c,setData:g,post:w,processing:o}=$({depositId:null}),[M,_]=r.useState(!1),[A,z]=r.useState("");r.useEffect(()=>{const t=setInterval(()=>{h(s=>s.map(a=>a.status==="pending"&&a.expires_at&&new Date(a.expires_at)-new Date<=0?{...a,status:"expired"}:a))},1e3);return()=>clearInterval(t)},[]);const j=(t,s)=>{h(a=>a.map(n=>n.id===t?{...n,status:s}:n))},B=t=>{confirm("Konfirmasi deposit ini?")&&(g("depositId",t),w(`/admin/deposit/confirm/${t}`,{onSuccess:()=>j(t,"confirmed")}))},T=()=>{_(!1),z("")},R=t=>{confirm("Batalkan konfirmasi deposit ini?")&&(g("depositId",t),w(`/admin/deposit/cancel-confirm/${t}`,{onSuccess:()=>j(t,"pending")}))},b=D.filter(t=>{var y,N,k,C;const s=((y=t.id)==null?void 0:y.toString().includes(i.toLowerCase()))||((k=(N=t.user)==null?void 0:N.name)==null?void 0:k.toLowerCase().includes(i.toLowerCase()))||((C=t.total_pay)==null?void 0:C.toString().includes(i.toLowerCase())),a=new Date(t.created_at),n=(!l.start||a>=new Date(l.start))&&(!l.end||a<=new Date(l.end));return s&&n}).sort((t,s)=>d==="desc"?new Date(s.created_at)-new Date(t.created_at):new Date(t.created_at)-new Date(s.created_at)),F=Math.ceil(b.length/10),v=b.slice((x-1)*10,x*10);return r.useEffect(()=>p(1),[i,d,l]),e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Manage Deposits"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] max-h-[892px] min-h-screen",children:[e.jsxs("div",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 bg-main",children:[e.jsx("div",{className:"w-full flex items-center justify-between px-4 py-2 bg-main",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Kelola Deposit"})]})}),e.jsxs("div",{className:"w-full h-max flex flex-col space-y-4 items-center justify-start p-4 bg-white shadow-lg",children:[e.jsxs("div",{className:"w-full h-9 flex flex-row mx-auto items-center justify-center pr-2 py-2 rounded-lg bg-neutral-100 border-2 border-gray-200",children:[e.jsx("input",{id:"searchInput",type:"text",className:"bg-transparent border-none flex-grow focus:ring-0 focus:outline-none placeholder-gray-400",placeholder:"Cari id/nama/total bayar",value:i,onChange:t=>S(t.target.value)}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.3",className:"w-5 h-5 text-main",children:e.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14A4.5 4.5 0 1 1 14 9.5 4.505 4.505 0 0 1 9.5 14z"})})]}),e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 items-center justify-start",children:[e.jsxs("button",{onClick:()=>I(t=>t==="desc"?"asc":"desc"),className:"w-full h-max flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-4 h-4 text-main",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"})}),e.jsx("span",{className:"text-utama text-sm font-thin text-left align-middle text-blue-600",children:d==="desc"?"Terbaru":"Terlama"})]}),e.jsx("div",{className:"shrink-0 w-px bg-main h-6",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",className:"w-full h-full",children:e.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})})}),e.jsxs("button",{onClick:()=>u(!f),className:"w-full h-max flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 text-main",children:e.jsx("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"})}),e.jsx("span",{className:"text-utama text-sm font-thin text-left align-middle text-blue-600",children:"Filter"})]})]})]}),f&&e.jsx("div",{className:"fixed h-screen px-4 inset-0 z-20 flex items-center justify-center bg-gray-800 bg-opacity-50",children:e.jsx("div",{className:"w-full max-w-[328px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs("div",{className:"w-full h-max flex flex-col space-y-4",children:[e.jsx("button",{className:"w-full flex justify-end",onClick:()=>u(!1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-7 h-7 text-red-500",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})}),e.jsx("h2",{className:"text-center text-utama text-lg font-medium",children:"Filter Tanggal"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-utama",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",className:"text-sm px-3 py-2 border border-gray-200 rounded-md bg-neutral-100",value:l.start,onChange:t=>m({...l,start:t.target.value})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-utama",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",className:"text-sm px-3 py-2 border border-gray-200 rounded-md bg-neutral-100",value:l.end,min:l.start?getNextDate(l.start):"",onChange:t=>m({...l,end:t.target.value})})]})]}),e.jsxs("div",{className:"w-full flex flex-col gap-2 mt-2",children:[e.jsx("button",{onClick:()=>m({start:"",end:""}),className:"w-full border border-red-300 text-red-500 text-sm py-2 rounded hover:bg-red-50 transition",children:"Reset Tanggal"}),e.jsx("button",{onClick:()=>u(!1),className:"w-full bg-blue-600 text-white text-sm py-2 rounded hover:bg-blue-700 transition",children:"Terapkan"})]})]})})})]}),e.jsxs("div",{className:"mb-4 min-h-[756px] pt-[163px] bg-white",children:[v.length>0?v.map(t=>{var s;return e.jsxs("div",{onClick:a=>{["BUTTON","A"].includes(a.target.tagName)||(window.location.href=`/deposit/${t.id}`)},className:"flex justify-between items-center p-3 border-b border-neutral-200 cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between w-full h-[120px] py-2",children:[e.jsxs("div",{className:"items-start flex flex-col",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",t.id]}),e.jsx("p",{className:"font-utama font-semibold text-sm truncate w-full max-w-[200px] [@media(max-width:350px)]:max-w-[215px]",children:(s=t.user)==null?void 0:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Rp",t.total_pay.toLocaleString()," (",t.payment_method||"Tidak Ada",")"]})]}),e.jsxs("p",{className:"flex items-center text-xs px-2 py-1 text-green-600 bg-green-100 border border-green-600 rounded-lg font-medium whitespace-nowrap",children:["Saldo Masuk: Rp",(t.get_saldo||0).toLocaleString("id-ID",{maximumFractionDigits:0})]})]}),e.jsxs("div",{className:"flex flex-col justify-between items-end w-full h-[120px] py-2",children:[e.jsxs("div",{className:"items-end flex flex-col space-y-2",children:[e.jsxs("span",{className:"text-xs font-semibold px-2 py-[2px] rounded-2xl capitalize bg-yellow-100 text-yellow-600",children:["Exp: ",new Date(t.expires_at).toLocaleString("id-ID",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})]}),e.jsx("div",{className:`text-xs font-semibold px-2 py-[2px] rounded-2xl capitalize
    ${t.status==="pending"?"bg-yellow-100 text-yellow-600":t.status==="confirmed"?"bg-green-100 text-green-600":t.status==="expired"?"bg-red-100 text-red-600":""}`,children:t.status})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[t.status!=="confirmed"?e.jsx("button",{onClick:()=>B(t.id),className:"text-[11px] bg-blue-500 hover:bg-blue-600 text-white px-2 py-[2px] rounded",disabled:o&&c.depositId===t.id,children:o&&c.depositId===t.id?"Memproses...":"Konfirmasi"}):e.jsx("button",{onClick:()=>R(t.id),className:"text-[11px] bg-red-500 hover:bg-red-600 text-white px-2 py-[2px] rounded",disabled:o&&c.depositId===t.id,children:o&&c.depositId===t.id?"Memproses...":"Batalkan Konfirmasi"}),t.proof_of_payment&&e.jsx("a",{href:`/proof-of-payment/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs rounded text-blue-600 hover:bg-gray-100 transition",children:"Lihat Bukti"})]})]})]},t.id)}):e.jsx("div",{className:"flex justify-center items-center h-full mt-6",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada pengguna ditemukan."})}),e.jsx("div",{className:"flex justify-center gap-2 mt-4 text-sm",children:Array.from({length:F}).map((t,s)=>e.jsx("button",{onClick:()=>p(s+1),className:`px-2 py-1 rounded ${x===s+1?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:s+1},s))})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:T,className:"absolute -top-3 -right-3 bg-white text-white rounded-full w-9 h-9 flex items-center justify-center shadow",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-7 h-7 text-red-500",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})}),e.jsx("img",{src:A,alt:"Bukti",className:"max-w-[90vw] max-h-[80vh] rounded shadow-lg"})]})})]})]})};export{V as default};
