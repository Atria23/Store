import{r as a,j as e,a as M,y as c}from"./app-C4HWBaj7.js";function F({auth:z,postpaidProducts:o=[],flash:i}){const[m,w]=a.useState(""),[d,j]=a.useState("asc"),[r,b]=a.useState(o);a.useEffect(()=>{b(o)},[o]),a.useEffect(()=>{i&&i.message&&alert(i.message)},[i]);const u=s=>s==null?void 0:s.toString().toLowerCase().replace(/[\s_-]+/g,""),n=[...m.trim()?r.filter(s=>{const t=u(m);return u([s.product_name,s.category,s.brand,s.buyer_sku_code,s.desc,s.admin,s.commission].filter(Boolean).join(" ")).includes(t)}):r].sort((s,t)=>d==="asc"?s.product_name.localeCompare(t.product_name):t.product_name.localeCompare(s.product_name)),x=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s).replace(/\s/g,""),v=()=>{c.post(route("postpaid.fetch"),{},{onSuccess:s=>{c.reload({only:["postpaidProducts"]})},onError:s=>{console.error("Gagal sinkronisasi:",s)}})},[l,h]=a.useState([]),[f,P]=a.useState(!1),[B,y]=a.useState({desc:"",seller_product_status:"",buyer_product_status:"",commission_sell_percentage:"",commission_sell_fixed:"",image:""}),[A,_]=a.useState({});a.useEffect(()=>{if(f){const s={};r.filter(t=>l.includes(t.id)).forEach(t=>{s[t.id]={desc:t.desc||"",seller_product_status:t.seller_product_status?"1":"0",buyer_product_status:t.buyer_product_status?"1":"0",commission_sell_percentage:t.commission_sell_percentage||"",commission_sell_fixed:t.commission_sell_fixed||"",image:t.image||""}}),_(s),y({desc:"",seller_product_status:"",buyer_product_status:"",commission_sell_percentage:"",commission_sell_fixed:"",image:""})}},[f,l,r]);const g=s=>l.includes(s),N=s=>{h(t=>g(s)?t.filter(p=>p!==s):[...t,s])},k=()=>{if(l.length===0){alert("Pilih produk terlebih dahulu.");return}c.get(route("postpaid.bulk-edit"),{ids:l})},C=()=>{l.length===n.length&&n.length>0?h([]):h(n.map(s=>s.id))},S=s=>{c.get(route("postpaid.bulk-edit"),{ids:[s]})};return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Kelola Produk Pascabayar"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] max-h-[892px] min-h-screen",children:[e.jsxs("div",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 bg-main",children:[e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 justify-start items-center px-4 py-2 bg-main",children:[e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 items-center justify-start",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Kelola Produk Pascabayar"})]}),e.jsx("button",{onClick:v,className:"flex items-center w-6 h-6",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-6 h-6 text-white",children:[e.jsx("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41m-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9"}),e.jsx("path",{fillRule:"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5 5 0 0 0 8 3M3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9z"})]})})]}),e.jsxs("div",{className:"w-full h-max flex flex-col space-y-4 items-center justify-start p-4 bg-white shadow-lg",children:[e.jsxs("div",{className:"w-full h-9 flex flex-row mx-auto items-center justify-center pr-2 py-2 rounded-lg bg-neutral-100 border-2 border-gray-200",children:[e.jsx("input",{id:"searchInput",type:"text",className:"bg-transparent border-none flex-grow focus:ring-0 focus:outline-none placeholder-gray-400",placeholder:"Cari produk",value:m,onChange:s=>w(s.target.value)}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.3",className:"w-5 h-5 text-main",children:e.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14A4.5 4.5 0 1 1 14 9.5 4.505 4.505 0 0 1 9.5 14z"})})]}),e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 items-center justify-start",children:[e.jsxs("button",{onClick:()=>j(d==="asc"?"desc":"asc"),className:"w-full h-max flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[d==="asc"?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 text-main",children:[e.jsx("path",{fillRule:"evenodd",d:"M10.082 5.629 9.664 7H8.598l1.789-5.332h1.234L13.402 7h-1.12l-.419-1.371zm1.57-.785L11 2.687h-.047l-.652 2.157z"}),e.jsx("path",{d:"M12.96 14H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645zM4.5 2.5a.5.5 0 0 0-1 0v9.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L4.5 12.293z"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 text-main",children:[e.jsx("path",{d:"M12.96 7H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645z"}),e.jsx("path",{fillRule:"evenodd",d:"M10.082 12.629 9.664 14H8.598l1.789-5.332h1.234L13.402 14h-1.12l-.419-1.371zm1.57-.785L11 9.688h-.047l-.652 2.156z"}),e.jsx("path",{d:"M4.5 2.5a.5.5 0 0 0-1 0v9.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L4.5 12.293z"})]}),e.jsx("span",{className:"text-utama text-sm font-thin text-left align-middle text-blue-600",children:"Urutkan"})]}),e.jsx("div",{className:"shrink-0 w-8 text-main",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",className:"w-full h-full",children:e.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})})}),e.jsxs("button",{className:"w-full h-max flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 text-main",children:e.jsx("path",{d:`M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5\r
.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z`})}),e.jsx("span",{className:"text-utama text-sm font-thin text-left align-middle text-blue-600",children:"Filter"})]})]}),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full border-b border-gray-400 mb-[200px]"}),e.jsxs("div",{className:"w-full flex flex-col space-y-3",children:[e.jsxs("div",{className:"w-full flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"w-max flex items-center justify-start space-x-2",children:[e.jsx("input",{type:"checkbox",checked:l.length===n.length&&n.length>0,onChange:C,className:"accent-main w-4 h-4"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Pilih Semua"})]}),e.jsx("div",{className:"w-max flex items-center space-x-2 justify-end",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[l.length," produk dipilih"]})})]}),e.jsxs("button",{onClick:k,className:"text-sm px-3 py-1.5 bg-main text-white rounded-md hover:bg-blue-700 transition",children:["Edit Massal (",l.length," item)"]})]})]})]})]}),l.length>0&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"mb-[100px]"})}),e.jsx("div",{className:"mb-4 min-h-[756px] pt-[163px] bg-white",children:e.jsx("div",{className:"mb-4 min-h-[756px] bg-white",children:n.length>0?n.map(s=>{(s.admin||0)-((s.commission||0)*(s.commission_sell_percentage||0)/100+(s.commission_sell_fixed||0));const t=(s.commission_sell_percentage||0)/100*(s.commission||0)+(s.commission_sell_fixed||0);return e.jsxs("div",{className:"flex justify-between items-center p-4 border-b-2 border-b-neutral-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:g(s.id),onChange:()=>N(s.id),className:"accent-main"}),e.jsx("img",{src:s.image?`/storage/${s.image}`:"/storage/brands/default.webp",alt:s.product_name,className:"w-12 h-12 rounded-xl object-cover shadow"}),e.jsxs("div",{className:"flex flex-col items-start space-y-1",children:[e.jsxs("p",{className:"font-utama font-semibold text-sm max-w-[150px] truncate",children:[s.product_name," - ",s.brand||"Tanpa Brand"]}),e.jsx("p",{className:"font-utama text-xs text-gray-500 max-w-[150px] truncate",children:s.brand||"Tanpa Brand"}),e.jsxs("div",{className:"font-utama text-xs text-gray-500 pt-1",children:[s.admin>0&&e.jsxs("div",{children:["Admin: ",e.jsx("span",{className:"font-semibold text-gray-700",children:x(s.admin)})]}),s.commission>0&&e.jsxs("div",{children:["Komisi: ",e.jsx("span",{className:"font-semibold text-gray-700",children:x(s.commission)})]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[t>0&&e.jsx("div",{className:"w-max h-max px-2 py-[2px] text-xs text-purple-600 rounded-3xl bg-purple-50 border border-purple-600",children:x(t)}),e.jsx("div",{className:`px-2 py-[2px] text-xs rounded-3xl ${s.seller_product_status?"text-green-600 bg-green-50 border border-green-600":"text-red-600 bg-red-50 border border-red-600"}`,children:s.seller_product_status?"Tersedia":"Gangguan"}),e.jsx("button",{type:"button",onClick:()=>S(s.id),className:"text-main text-xs font-semibold hover:underline focus:outline-none pt-2",children:"Edit"})]})]},s.id)}):e.jsx("p",{className:"p-4 text-center",children:"Produk tidak ditemukan"})})})]})]})}export{F as default};
