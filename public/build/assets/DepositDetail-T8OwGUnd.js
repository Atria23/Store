import{r as l,j as e,a as X}from"./app-lp4FbsWR.js";import{z as h}from"./index-CEGM-DrG.js";const W=({deposit:t})=>{const[S,w]=l.useState(!1),[_,g]=l.useState(""),[p,j]=l.useState(!1),[y,b]=l.useState(null),[x,v]=l.useState(null),[C,N]=l.useState(""),[I,M]=l.useState(!1),[T,A]=l.useState(!1),[R,D]=l.useState(!1),[L,r]=l.useState(""),[f,P]=l.useState(null),[B,m]=l.useState(!1),[O,i]=l.useState(!1),[E,o]=l.useState("");l.useEffect(()=>{if(t.status==="pending"&&t.expires_at){const a=()=>{const n=new Date(t.expires_at)-new Date;if(n<=0)N("Expired"),fetch("/deposit/check-expired",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content}}).then(()=>{location.reload()});else{const c=Math.floor(n/36e5),H=Math.floor(n%(1e3*60*60)/(1e3*60)),Z=Math.floor(n%(1e3*60)/1e3);N(`${c.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}`)}};a();const s=setInterval(a,1e3);return()=>clearInterval(s)}},[t.status,t.expires_at]);const d=a=>`Rp${parseInt(a).toLocaleString("id-ID")}`,F=new Date(t.created_at).toLocaleString("id-ID",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}),$=new Date(t.expires_at).toLocaleString("id-ID",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}),q=a=>a?a.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "):"",K=(a,s)=>{navigator.clipboard.writeText(a),s(!0),setTimeout(()=>s(!1),1500)},V=(a,s)=>{navigator.clipboard.writeText(a.toString()).then(()=>{s(!0),setTimeout(()=>s(!1),2e3)}).catch(n=>console.error("Failed to copy Total Pay: ",n))},z=(a,s)=>{navigator.clipboard.writeText(a),s(!0),setTimeout(()=>s(!1),1500)},Y=a=>{o("Apakah Anda yakin ingin mengonfirmasi deposit ini?"),r("confirm"),m(!0),i(!0),P(a)},G=()=>{f&&(j(!0),b(f),fetch(`/deposit/confirm/${f}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({})}).then(a=>a.json()).then(a=>{a.success?(o("Deposit berhasil dikonfirmasi!"),m(!1),r("confirm"),i(!0),setTimeout(()=>{window.location.href="/deposit"},1e3)):(o("Gagal mengonfirmasi: data tidak ditemukan."),m(!1),r("confirm"),i(!0))}).catch(a=>{o("Terjadi kesalahan: "+a.message),m(!1),r("confirm"),i(!0)}).finally(()=>{j(!1),b(null)}))},k=(a,s)=>{if(!s)return;v(a);const n=new FormData;n.append("proof_of_payment",s),fetch(`/deposit/upload-proof/${a}`,{method:"POST",body:n,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then(c=>c.json()).then(c=>{c.success?(o("Bukti pembayaran berhasil diupload!"),r("upload"),setTimeout(()=>{window.location.href="/deposit"},1500)):(o("Gagal mengupload bukti pembayaran."),r("upload"))}).catch(c=>{console.error("Error uploading proof:",c),o("Terjadi kesalahan saat mengupload bukti."),r("upload")}).finally(()=>{v(null),i(!0)})},u=a=>{g(a),w(!0)},U=()=>{w(!1),g("")};return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Detail Deposit"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] flex flex-col min-h-screen",children:[e.jsx("header",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 flex flex-row space-x-4 justify-start items-center px-4 py-2 bg-main",children:e.jsxs("div",{className:"w-full flex flex-row space-x-4 items-center justify-start",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Detail Deposit"})]})}),e.jsxs("main",{className:"w-full w-max-[500px] flex flex-col space-y-3 mt-12 [@media(max-width:277px)]:mt-[76px] p-4 bg-main-white",children:[t.status==="pending"&&e.jsx("div",{className:"w-full text-justify bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-3 text-sm rounded-xl",children:"Pastikan melakukan pembayaran deposit sebelum batas pembayaran. Jika terdapat kesalahan nominal pembayaran, maka jumlah saldo masuk akan dikurangi 5%."}),e.jsxs("div",{className:"w-full flex flex-col space-y-8 items-center justify-center p-6 rounded-3xl bg-white shadow-md",children:[e.jsxs("div",{className:"w-full h-max flex flex-col space-y-4 items-start justify-center",children:[e.jsxs("div",{className:"w-full flex justify-center",children:[t.status==="pending"&&e.jsx("div",{className:"w-24 h-24 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",className:"w-14 h-14 text-yellow-500",fill:"currentColor",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"})})}),t.status==="confirmed"&&e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",className:"w-14 h-14 text-green-500",fill:"currentColor",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"})})}),t.status!=="pending"&&t.status!=="confirmed"&&e.jsx("div",{className:"w-24 h-24 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-14 h-14 text-red-500",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:`text-center text-sm font-medium px-4 py-1 rounded-full ${t.status==="pending"?"text-yellow-700 bg-yellow-100":t.status==="confirmed"?"text-green-700 bg-green-100":"text-red-700 bg-red-100"}`,children:t.status})})]}),e.jsx("div",{className:"w-full h-px bg-gray-600"}),e.jsxs("div",{className:"w-full flex flex-col space-y-2 items-start justify-center",children:[e.jsxs("div",{className:"w-full flex flex-col space-y-2 items-start justify-start",children:[e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"ID"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words flex items-center justify-end gap-1",children:e.jsx("div",{className:"flex items-center justify-end gap-2 text-sm font-medium text-right font-utama tracking-[0.1px]",children:I?e.jsx("div",{className:"w-20",children:e.jsx(h,{src:"https://lottie.host/519fbc9d-1e9b-4ddf-ab6f-14423aabd845/MtxYOaYcV8.lottie",autoplay:!0,loop:!1,style:{width:"100%",height:"100%"}})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"break-words",children:t.id}),e.jsx("button",{onClick:()=>K(t.id,M),className:"text-main hover:text-blue-700 font-medium","aria-label":"Copy Ref Id",children:e.jsxs("svg",{className:"w-5 h-5 shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{fillRule:"evenodd",d:"M7 9v6a4 4 0 0 0 4 4h4a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1v2Z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M13 3.054V7H9.2a2 2 0 0 1 .281-.432l2.46-2.87A2 2 0 0 1 13 3.054ZM15 3v4a2 2 0 0 1-2 2H9v6a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-3Z",clipRule:"evenodd"})]})})]})})})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Dibuat pada"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:F})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Batas Pembayaran"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm text-red-500 font-medium tracking-[0.1px] break-words",children:t.status==="expired"?$:C})]}),e.jsx("div",{className:"w-full h-px border border-dashed border-gray-400 my-4"}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Metode Pembayaran"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:q(t.payment_method)})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Nominal"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:d(t.amount)})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Kode Unik"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:d(t.unique_code)})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Biaya Admin"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:d(t.admin_fee)})]}),e.jsx("div",{className:"w-full h-px border border-dashed border-gray-400 my-4"}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-medium tracking-[0.25px] break-words",children:"Saldo Masuk"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:d(t.get_saldo)})]})]}),e.jsx("div",{className:"w-full h-px border border-dashed border-gray-400 my-4"}),e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"text-md font-utama font-medium text-gray-700",children:"Total Bayar"}),e.jsx("div",{className:"flex items-center gap-2",children:T?e.jsx("div",{className:"w-20",children:e.jsx(h,{src:"https://lottie.host/519fbc9d-1e9b-4ddf-ab6f-14423aabd845/MtxYOaYcV8.lottie",autoplay:!0,loop:!1,style:{width:"100%",height:"100%"}})}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-md font-utama font-semibold text-black",children:d(t.total_pay)}),e.jsx("button",{onClick:()=>V(t.total_pay,A),className:"text-main hover:text-blue-700 font-medium","aria-label":"Copy Total Bayar",children:e.jsxs("svg",{className:"w-5 h-5 shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{fillRule:"evenodd",d:"M7 9v6a4 4 0 0 0 4 4h4a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1v2Z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M13 3.054V7H9.2a2 2 0 0 1 .281-.432l2.46-2.87A2 2 0 0 1 13 3.054ZM15 3v4a2 2 0 0 1-2 2H9v6a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-3Z",clipRule:"evenodd"})]})})]})})]})]})]}),(t.payment_method==="qris_otomatis"||t.payment_method==="qris_dana"||t.payment_method==="qris_shopeepay"||t.payment_method==="qris_ovo"||t.payment_method==="qris_gopay")&&t.admin_account?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full flex flex-col space-y-4 items-center justify-center p-4 rounded-3xl bg-white shadow-md",children:[e.jsx("div",{className:"w-full h-max flex flex-col space-y-4 items-start justify-center",children:e.jsx("p",{className:"w-full font-utama font-semibold text-xl break-words text-wrap text-center",children:"Rekening QRIS"})}),e.jsx("div",{className:"w-full h-px bg-gray-600"}),e.jsx("img",{src:`/storage/${t.admin_account}`,alt:`QRIS ${t.payment_method}`,className:"w-64 object-cover cursor-pointer rounded",onClick:()=>u(`/storage/${t.admin_account}`)}),e.jsx("div",{className:"w-full h-max mt-2 flex flex-col items-center justify-center",children:e.jsx("button",{onClick:()=>u(`/storage/${t.admin_account}`),className:"w-full bg-main text-white p-2 rounded-xl hover:bg-blue-700 transition",children:"PERBESAR GAMBAR"})})]})}):t.admin_account&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full flex flex-col space-y-4 items-center justify-center p-4 rounded-3xl bg-white shadow-md",children:[e.jsx("div",{className:"w-full h-max flex flex-col space-y-4 items-start justify-center",children:e.jsx("p",{className:"w-full font-utama font-semibold text-xl break-words text-wrap text-center",children:"Rekening Pembayaran"})}),e.jsx("div",{className:"w-full h-px bg-gray-600"}),e.jsx("div",{className:"w-full h-max flex flex-col space-y-4 items-start justify-center",children:R?e.jsx("div",{className:"w-full flex items-center justify-center",children:e.jsx("div",{className:"w-20",children:e.jsx(h,{src:"https://lottie.host/519fbc9d-1e9b-4ddf-ab6f-14423aabd845/MtxYOaYcV8.lottie",autoplay:!0,loop:!1,style:{width:"100%",height:"100%"}})})}):e.jsx("p",{className:"w-full font-utama font-semibold text-xl break-words text-wrap text-center",children:t.admin_account})}),e.jsx("div",{className:"w-full h-max mt-2 flex flex-col items-center justify-center",children:e.jsx("button",{onClick:()=>z(t.admin_account,D),className:"w-full bg-main text-white p-2 rounded-xl hover:bg-blue-700 transition",children:"SALIN NOMOR REKENING"})})]})}),e.jsxs("div",{className:"w-full flex flex-col space-y-4 items-center justify-center p-4 rounded-3xl bg-white shadow-md",children:[e.jsx("div",{className:"w-full flex flex-col space-y-4 items-center justify-center",children:e.jsx("p",{className:"w-full font-utama font-semibold text-xl text-center break-words",children:"Unggah Bukti Pembayaran"})}),e.jsx("div",{className:"w-full h-px bg-gray-600"}),t.proof_of_payment?e.jsxs("div",{className:"w-full flex flex-col items-center justify-center space-y-4",children:[e.jsx("img",{src:`/proof-of-payment/${t.id}`,alt:"Proof of Payment",className:"w-64 object-cover rounded cursor-pointer",onClick:()=>u(`/proof-of-payment/${t.id}`)}),t.status==="pending"&&(!t.expires_at||new Date(t.expires_at)>new Date)&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"upload-proof",className:"w-full text-center bg-main text-white py-2 px-4 rounded-xl hover:bg-blue-700 cursor-pointer transition text-sm",children:"GANTI BUKTI PEMBAYARAN"}),e.jsx("input",{id:"upload-proof",type:"file",accept:"image/*",onChange:a=>k(t.id,a.target.files[0]),className:"hidden",disabled:x===t.id})]})]}):t.status==="confirmed"||new Date(t.expires_at)<=new Date?e.jsx("p",{className:"text-gray-400 text-center",children:"N/A"}):t.payment_method==="qris_otomatis"?e.jsx("button",{onClick:()=>Y(t.id),className:"w-full bg-main text-white py-2 px-4 rounded-xl hover:bg-blue-700 transition",disabled:p||y===t.id,children:p&&y===t.id?"MENGKONFIRMASI...":"KONFIRMASI DEPOSIT"}):e.jsxs("div",{className:"w-full flex flex-col items-center justify-center space-y-2",children:[e.jsx("label",{htmlFor:"upload-proof",className:"w-full text-center bg-main text-white py-2 px-4 rounded-xl hover:bg-blue-700 cursor-pointer transition text-sm",children:"UNGGAH BUKTI PEMBAYARAN"}),e.jsx("input",{id:"upload-proof",type:"file",accept:"image/*",onChange:a=>k(t.id,a.target.files[0]),className:"hidden",disabled:x===t.id}),x===t.id&&e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Sedang mengunggah..."})]})]})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:U,className:"absolute top-0 right-0 text-white text-xl bg-red-500 rounded-full px-3 py-1 m-2",children:"×"}),e.jsx("img",{src:_,alt:"Preview",className:"max-w-full max-h-[80vh] rounded-lg shadow-lg"})]})}),O&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl w-[90%] max-w-[400px] text-center space-y-4",children:[e.jsx("p",{className:"text-md font-semibold",children:E}),e.jsx("div",{className:"flex justify-center gap-2",children:L==="confirm"&&B?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:G,className:"w-full bg-main text-white px-4 py-2 rounded font-semibold text-sm",children:"Ya"}),e.jsx("button",{onClick:()=>i(!1),className:"w-full bg-gray-500 text-white px-4 py-2 rounded font-semibold text-sm",children:"Tidak"})]}):e.jsx("button",{onClick:()=>i(!1),className:"bg-main text-white px-4 py-2 rounded font-semibold text-sm w-full",children:"OK"})})]})})]})};export{W as default};
