import{r as a,W,j as e,a as K,y as H}from"./app-lsBfv2o2.js";const X=({deposits:z})=>{const[B,q]=a.useState(z);W();const[x,I]=a.useState(""),[c,j]=a.useState(""),[m,b]=a.useState(""),[u,P]=a.useState("desc"),[v,h]=a.useState(!1),[r,d]=a.useState(1),[N,k]=a.useState(!1),[C,_]=a.useState(null),[R,i]=a.useState(!1),[$,f]=a.useState(""),[O,g]=a.useState(""),[p,D]=a.useState(null),V=t=>{D(t),f("Apakah kamu yakin ingin mengonfirmasi deposit ini?"),g("confirm"),i(!0)},E=()=>{p&&(k(!0),_(p),fetch(`/deposit/confirm/${p}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({})}).then(t=>t.json()).then(t=>{t.success?window.location.reload():(f("Konfirmasi gagal: tidak ditemukan data yang sesuai."),g("info"),i(!0))}).catch(t=>{f("Terjadi kesalahan: "+t.message),g("info"),i(!0)}).finally(()=>{k(!1),_(null),D(null)}))};a.useEffect(()=>{const t=setInterval(()=>{q(s=>s.map(l=>l.status==="pending"&&l.expires_at&&new Date(l.expires_at)-new Date<=0?{...l,status:"expired"}:l))},1e3);return()=>clearInterval(t)},[]);const S=t=>t?t.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "):"",F=()=>{j(""),b(""),setDateRange({start:"",end:""})},w=10;a.useEffect(()=>{d(1)},[x,u]);const L=t=>t==="qris_otomatis",[y,U]=a.useState("semua"),M=B.filter(t=>y==="manual"?!L(t.payment_method):y==="otomatis"?L(t.payment_method):!0).filter(t=>{var l,n,A;const s=x.toLowerCase();return(((l=t.payment_method)==null?void 0:l.toLowerCase())||"").includes(s)||(((n=t.id)==null?void 0:n.toString())||"").includes(s)||(((A=t.total_pay)==null?void 0:A.toString())||"").includes(s)}).filter(t=>{const s=new Date(t.created_at),l=c?new Date(c):null,n=m?new Date(m):null;return!(l&&s<l||n&&s>new Date(n.getTime()+864e5))}).sort((t,s)=>{const l=new Date(t.created_at).getTime(),n=new Date(s.created_at).getTime();return u==="asc"?l-n:n-l}),o=Math.ceil(M.length/w),T=M.slice((r-1)*w,r*w);return e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Deposit History"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] max-h-[892px] min-h-screen",children:[e.jsxs("div",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 bg-main",children:[e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 items-center justify-start px-4 py-2 bg-main",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Riwayat Deposit"})]}),e.jsxs("div",{className:"w-full h-max flex flex-col space-y-4 items-center justify-start p-4 bg-white shadow-lg",children:[e.jsx("div",{className:"flex w-full space-x-2 bg-main-white rounded-full",children:["semua","manual","otomatis"].map(t=>e.jsx("button",{onClick:()=>U(t),className:`flex-1 py-1 rounded-full text-sm ${y===t?"bg-main text-white":"bg-main-white text-gray-600"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsxs("div",{className:"w-full h-9 flex flex-row mx-auto items-center justify-center pr-2 py-2 rounded-lg bg-neutral-100 border-2 border-gray-200",children:[e.jsx("input",{type:"text",className:"bg-transparent border-none flex-grow focus:ring-0 focus:outline-none placeholder-gray-400",placeholder:"Cari ID / nominal / metode",value:x,onChange:t=>I(t.target.value.toLowerCase())}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.3",className:"w-5 h-5 text-main",children:e.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14A4.5 4.5 0 1 1 14 9.5 4.505 4.505 0 0 1 9.5 14z"})})]}),e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 items-center justify-start",children:[e.jsxs("button",{onClick:()=>P(t=>t==="desc"?"asc":"desc"),className:"w-full h-max flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-4 h-4 text-main",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"})}),e.jsx("span",{className:"text-utama text-sm font-thin text-left align-middle text-blue-600",children:u==="desc"?"Terbaru":"Terlama"})]}),e.jsx("div",{className:"shrink-0 w-px bg-main h-6",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",className:"w-full h-full",children:e.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})})}),e.jsxs("button",{onClick:()=>h(!v),className:"w-full h-max flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 text-main",children:e.jsx("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"})}),e.jsx("span",{className:"text-utama text-sm font-thin text-left align-middle text-blue-600",children:"Filter"})]})]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-20 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-[328px] p-4 bg-white rounded-lg shadow-lg",children:[e.jsx("button",{className:"w-full flex justify-end",onClick:()=>h(!1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-7 h-7 text-red-500",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})}),e.jsx("h2",{className:"text-center text-main text-lg font-medium mb-4",children:"Filter Tanggal"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-main",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",className:"text-sm px-3 py-2 border border-gray-200 rounded-md bg-neutral-100",value:c,onChange:t=>j(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-main",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",className:"text-sm px-3 py-2 border border-gray-200 rounded-md bg-neutral-100",value:m,min:c||void 0,onChange:t=>b(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:F,className:"border border-red-300 text-red-500 text-sm py-2 rounded hover:bg-red-50",children:"Reset"}),e.jsx("button",{onClick:()=>h(!1),className:"bg-main text-white text-sm py-2 rounded hover:opacity-90",children:"Terapkan"})]})]})]})}),e.jsxs("div",{className:"pt-[225px] px-4 pb-8 bg-white",children:[T.length>0?e.jsx("div",{className:"space-y-2",children:T.map(t=>e.jsxs("div",{onClick:()=>H.visit(`/deposit/${t.id}`),className:"flex justify-between items-center p-3 border-b border-gray-100 cursor-pointer w-full gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"aspect-square w-14 bg-white rounded-xl shadow hidden min-[350px]:flex items-center justify-center overflow-hidden",children:["ovo","gopay","shopeepay","dana","linkaja","qris_otomatis","qris_dana","qris_gopay","qris_shopeepay","qris_ovo"].includes(t.payment_method)?e.jsx("img",{src:`/storage/payment_method/${t.payment_method}.png`,alt:S(t.payment_method),className:"w-full h-full object-contain"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-full h-full object-contain text-main",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.01-.003.268-.108a.75.75 0 0 1 .558 0l.269.108.01.003zM10.404 2 4.25 4.461 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339L8 5.961 5.596 5l6.154-2.461z"})})}),e.jsxs("div",{className:"flex flex-col space-y-0.5 text-sm w-full",children:[e.jsxs("p",{className:"font-semibold text-gray-800 truncate",children:["Rp",Number(t.total_pay).toLocaleString("id-ID")]}),e.jsx("p",{className:"text-gray-600",children:S(t.payment_method)}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["ID: ",t.id]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-1 items-end justify-center w-full",children:[t.proof_of_payment===null&&t.payment_method!=="qris_otomatis"&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-yellow-500 font-medium",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01M12 2a10 10 0 100 20 10 10 0 000-20z"})}),e.jsx("span",{children:"Unggah Bukti"})]}),e.jsx("span",{className:`text-xs font-semibold px-2 py-[2px] rounded-2xl capitalize
                          ${t.status==="pending"&&t.expires_at?"bg-yellow-100 text-yellow-600":t.status==="confirmed"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:t.status}),t.payment_method==="qris_otomatis"&&t.status==="pending"&&e.jsx("button",{type:"button",onClick:s=>{s.preventDefault(),s.stopPropagation(),V(t.id)},disabled:N&&C===t.id,className:"text-[11px] mt-1 bg-blue-500 hover:bg-blue-600 text-white px-2 py-[2px] rounded",children:N&&C===t.id?"Memproses...":"Konfirmasi"}),e.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:new Date(t.created_at).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},t.id))}):e.jsx("div",{className:"flex justify-center items-center h-full mt-6",children:e.jsx("p",{className:"text-gray-500",children:"Deposit tidak ditemukan."})}),o>1&&e.jsx("div",{className:"w-full flex justify-center py-4",children:e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-1 max-w-full px-2",children:[e.jsx("button",{onClick:()=>d(t=>Math.max(t-1,1)),disabled:r===1,className:`px-2 py-1 text-xs rounded border transition-all ${r===1?"bg-gray-200 text-gray-500 cursor-not-allowed border-gray-200":"bg-white hover:bg-gray-100 text-main border-gray-300"}`,children:"« Prev"}),Array.from({length:o},(t,s)=>s+1).map(t=>e.jsx("button",{onClick:()=>d(t),className:`px-2 py-1 text-xs rounded border transition-all ${t===r?"bg-main text-white border-main":"bg-white hover:bg-gray-100 text-main border-gray-300"}`,children:t},t)),e.jsx("button",{onClick:()=>d(t=>Math.min(t+1,o)),disabled:r===o,className:`px-2 py-1 text-xs rounded border transition-all ${r===o?"bg-gray-200 text-gray-500 cursor-not-allowed border-gray-200":"bg-white hover:bg-gray-100 text-main border-gray-300"}`,children:"Next »"})]})})]})]}),R&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-sm w-full",children:[e.jsx("p",{className:"text-center mb-4",children:$}),O==="confirm"?e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:()=>{i(!1),E()},className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Ya"}),e.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-gray-300 text-black rounded-md",children:"Batal"})]}):e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Oke"})})]})})]})};export{X as default};
