import{q as y,r as o,j as e}from"./app-CkWPU0_3.js";import{F as b,d as j}from"./Footer-Lkrsnkm5.js";const w=({ref_id:r,product_name:s,customer_no:c,price:i,status:d,created_at:m})=>{const x={Sukses:"bg-green-100 text-green-600",Pending:"bg-yellow-100 text-yellow-600",Gagal:"bg-red-100 text-red-600"},l=new Date(m).toLocaleString("id-ID",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}),u=n=>n.length>=6?n.slice(0,3)+"****"+n.slice(-3):n.slice(0,3)+(n.length>3?"****":""),g=()=>{j.Inertia.visit(`/history/${r}`)};return e.jsxs("div",{onClick:g,className:"flex items-center p-4 rounded-lg shadow-md bg-white my-2 cursor-pointer",children:[e.jsx("div",{className:"w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-full shadow bg-blue-50 text-blue-600 mr-4",children:e.jsx("img",{src:"/storage/logo.webp",alt:"Company Logo",className:"rounded-lg"})}),e.jsxs("div",{className:"flex-grow overflow-hidden",children:[e.jsx("div",{className:"text-md font-semibold text-gray-700 truncate",children:s}),e.jsxs("div",{className:"text-sm font-bold text-blue-500 truncate",children:["ID: ",u(c)]}),e.jsx("div",{className:"text-sm text-gray-500 truncate",children:e.jsxs("span",{className:"font-semibold bg-gray-200 px-2 py-1 rounded",children:["#",r]})}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:l})]}),e.jsx("div",{className:"flex flex-col items-end ml-4",children:e.jsx("span",{className:`px-3 py-1 mt-2 text-sm font-medium rounded-lg ${x[d]}`,children:d})})]})},k=()=>{const{transactions:r}=y().props,[s,c]=o.useState(r.slice(0,10)),[i,d]=o.useState(""),[m,x]=o.useState(r.length>10),[l,u]=o.useState(!1),g=()=>{s.forEach(t=>{t.status==="Pending"&&fetch("/transactions/update-status",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector("meta[name='csrf-token']").getAttribute("content")},body:JSON.stringify({transaction_id:t.ref_id})}).then(a=>a.json()).then(a=>{a.success&&c(p=>p.map(h=>h.ref_id===t.ref_id?{...h,status:a.new_status||h.status}:h))}).catch(a=>console.error("Error updating transaction status:",a))})};o.useEffect(()=>{const t=setInterval(()=>{g()},1e3);return()=>clearInterval(t)},[s]);const n=()=>{if(l)return;u(!0);const t=r.slice(s.length,s.length+10);c(a=>[...a,...t]),s.length+t.length>=r.length&&x(!1),u(!1)},f=s.filter(t=>t.product_name.toLowerCase().includes(i.toLowerCase())||t.customer_no.toLowerCase().includes(i.toLowerCase())||t.ref_id.toLowerCase().includes(i.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-blue-600 text-white py-4 px-6 shadow-md",children:e.jsx("h1",{className:"text-lg font-semibold",children:"Riwayat Transaksi"})}),e.jsx("div",{className:"sticky top-[60px] z-20 bg-gray-50 px-6 py-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari transaksi",value:i,onChange:t=>d(t.target.value),className:"w-full p-3 pl-12 pr-12 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-300"}),e.jsx("svg",{className:"w-6 h-6 text-blue-600 absolute left-4 top-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",d:"m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-2",children:f.length>0?f.map(t=>e.jsx(w,{...t},t.ref_id)):e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada transaksi ditemukan."})})}),m&&e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("button",{onClick:n,className:"px-6 py-2 text-white bg-blue-600 rounded-lg shadow-md hover:bg-blue-700 disabled:bg-gray-300",disabled:l,children:l?"Memuat...":"Muat Lebih Banyak"})})]}),e.jsx("div",{className:"pt-16",children:e.jsx(b,{})})]})};export{k as default};
