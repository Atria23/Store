import{r as s,j as e,a as D,y as T}from"./app-D6SJPRYN.js";function F({product:t,balance:n}){const[g,j]=s.useState(""),[b,v]=s.useState(t.price),[h,N]=s.useState(""),[d,y]=s.useState("Tidak tersedia"),[i,m]=s.useState(!1),[c,k]=s.useState(""),[f,r]=s.useState(""),[S,w]=s.useState(!1),[x,C]=s.useState(!1),[u,M]=s.useState(!1);s.useEffect(()=>{const l=new URLSearchParams(window.location.search),o=l.get("customerNo"),p=l.get("phone");y(o||p||"Tidak tersedia")},[]);const R=()=>{N("Saat ini belum ada promo tersedia."),v(t.price)},a=Number(b)+Number(t.admin||0)-Number(t.discount||0),I=()=>{if(n<a){r("Saldo tidak mencukupi untuk melakukan transaksi.");return}w(!0)},P=async l=>{if(l.preventDefault(),!i){if(r(""),!t||d==="Tidak tersedia"){r("Mohon lengkapi nomor pelanggan dan pilih produk.");return}if(n<a){r("Saldo tidak mencukupi untuk melakukan transaksi.");return}if(!c){r("Silakan masukkan password untuk melanjutkan.");return}m(!0);try{if(!(await(await fetch("/auth/verify-password",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({password:c})})).json()).success){r("Password salah. Silakan coba lagi."),m(!1);return}const B=await fetch("/transactions",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({buyer_sku_code:t.buyer_sku_code,customer_no:d,max_price:a,price_product:t.price,testing:!1})});T.visit("/history")}catch(o){console.error("Error:",o),r("Terjadi kesalahan saat mengirim permintaan transaksi."),m(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Checkout"}),e.jsxs("div",{className:"mx-auto w-full max-w-[500px] flex flex-col min-h-screen overflow-auto",children:[e.jsx("header",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 flex flex-row space-x-4 justify-start items-center px-4 py-2 bg-main",children:e.jsxs("div",{className:"w-full flex flex-row space-x-4 items-center justify-start",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Checkout"})]})}),e.jsx("div",{className:"w-full px-4 py-2 pt-14",children:e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg shadow border",children:[e.jsxs("p",{className:"w-full h-max font-utama font-semibold text-sm text-left flex items-center space-x-2",children:[e.jsxs("svg",{className:"w-6 h-6 text-main","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[e.jsx("path",{fillRule:"evenodd",d:"M12 14a3 3 0 0 1 3-3h4a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-4a3 3 0 0 1-3-3Zm3-1a1 1 0 1 0 0 2h4v-2h-4Z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M12.293 3.293a1 1 0 0 1 1.414 0L16.414 6h-2.828l-1.293-1.293a1 1 0 0 1 0-1.414ZM12.414 6 9.707 3.293a1 1 0 0 0-1.414 0L5.586 6h6.828ZM4.586 7l-.056.055A2 2 0 0 0 3 9v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2h-4a5 5 0 0 1 0-10h4a2 2 0 0 0-1.53-1.945L17.414 7H4.586Z",clipRule:"evenodd"})]}),e.jsx("span",{children:"DompetMu"})]}),e.jsxs("div",{className:"w-max h-max flex flex-row space-x-4 items-center justify-start max-w-[70%]",children:[e.jsx("p",{className:"font-utama font-bold text-sm break-words max-w-[150px] overflow-hidden text-ellipsis",children:x?`Rp${parseFloat(n).toLocaleString("id-ID")}`:"••••••••"}),e.jsx("button",{onClick:()=>C(!x),className:"text-main hover:text-blue-700",children:x?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",className:"bi bi-eye-slash-fill",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),e.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",className:"bi bi-eye-fill",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"}),e.jsx("path",{d:"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"})]})})]})]})}),e.jsx("main",{className:"w-full w-max-[500px] justify-center px-4 py-2 pb-36 bg-main-white",children:e.jsxs("div",{className:"w-full flex flex-col items-start justify-center p-4 rounded-lg bg-white shadow-md",children:[e.jsx("p",{className:"w-full font-utama font-semibold text-md text-center",children:"Detail Pembayaran"}),e.jsx("div",{className:"w-full h-px bg-gray-300 my-3"}),e.jsxs("div",{className:"w-full flex flex-col space-y-2 items-start justify-center",children:[e.jsxs("div",{className:"w-full flex flex-col space-y-2 items-start justify-start",children:[e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Nama Produk"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:t.product_name})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"ID Tujuan"}),e.jsx("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:d})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Harga"}),e.jsxs("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:["Rp",new Intl.NumberFormat("id-ID").format(t.price)]})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Biaya Admin"}),e.jsxs("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:["Rp",new Intl.NumberFormat("id-ID").format(t.admin||0)]})]}),e.jsxs("div",{className:"w-full flex flex-row",children:[e.jsx("div",{className:"w-1/2 text-left font-utama text-sm text-gray-800 font-normal tracking-[0.25px] break-words",children:"Diskon"}),e.jsxs("div",{className:"w-1/2 text-right font-utama text-sm font-medium tracking-[0.1px] break-words",children:["Rp",new Intl.NumberFormat("id-ID").format(t.discount||0)]})]})]}),e.jsx("div",{className:"w-full h-px bg-gray-300 my-4"}),e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"w-1/2 text-md font-utama font-medium text-gray-700 break-words",children:"Total Pembayaran"}),e.jsxs("span",{className:"w-1/2 text-right text-md font-utama font-semibold text-black break-words",children:["Rp",new Intl.NumberFormat("id-ID").format(a)]})]})]})]})}),e.jsxs("footer",{className:"fixed bottom-0 mt-auto w-full max-w-[500px] px-4 py-2 bg-white shadow-lg border-t rounded-t-xl",children:[h&&e.jsx("p",{className:"my-2 text-red-500 text-sm",children:h}),e.jsxs("div",{className:"relative w-full h-10",children:[e.jsx("input",{id:"searchInput",type:"text",className:"w-full h-full bg-neutral-100 border-2 border-gray-200 rounded-lg pr-20 pl-3 text-sm focus:ring-0 focus:outline-none placeholder-gray-400",value:g,onChange:l=>j(l.target.value),placeholder:"Masukkan kode promo"}),e.jsx("button",{onClick:R,className:"absolute right-2 top-1/2 -translate-y-1/2 text-main text-sm px-3 py-1.5 rounded hover:text-blue-700 transition",children:"GUNAKAN"})]}),e.jsx("div",{className:"w-full h-px bg-gray-300 my-2"}),e.jsxs("div",{className:"flex flex-row items-center justify-between w-full",children:[e.jsxs("div",{className:"text-justify",children:[e.jsx("p",{className:"text-md text-black font-medium",children:"Total Pembayaran"}),e.jsxs("p",{className:"text-lg text-main font-bold",children:["Rp",new Intl.NumberFormat("id-ID").format(a)]})]}),e.jsx("button",{onClick:I,disabled:n<a,className:`text-white px-3 py-2 rounded flex items-center gap-2 ${n<a?"bg-gray-400 cursor-not-allowed":"bg-main hover:bg-blue-700 transition"}`,children:e.jsx("span",{className:"font-semibold text-sm",children:n<a?"Saldo Kurang":"Bayar"})})]})]}),S&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-80",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Masukkan Password"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:u?"text":"password",value:c,onChange:l=>k(l.target.value),className:"w-full border p-2 pr-10 rounded",placeholder:"Masukkan password"}),e.jsx("div",{className:"absolute right-3 inset-y-0 my-auto flex items-center cursor-pointer",onClick:()=>M(!u),children:u?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",className:"text-main",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"}),e.jsx("path",{d:"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",className:"text-main",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),e.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})]}),f&&e.jsx("p",{className:"text-red-500 text-sm mb-2",children:f}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 hover:bg-gray-200 border rounded",children:"Batal"}),e.jsx("button",{onClick:P,disabled:i,className:`px-4 py-2 rounded text-white w-full ${i?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:i?"Memproses...":"Konfirmasi"})]})]})})]})]})}export{F as default};
