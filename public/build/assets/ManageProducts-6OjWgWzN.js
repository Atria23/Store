import{r as m,j as e,a as N,d as w,y as k}from"./app-kbbnvP7I.js";function C({auth:f,postpaidProducts:c,errors:p={},flash:x}){const[l,y]=m.useState({desc:"",seller_product_status:"",buyer_product_status:"",commission_sell_percentage:"",commission_sell_fixed:"",image:""}),[h,u]=m.useState([]),[_,g]=m.useState(!1);m.useEffect(()=>{const t=c.map(s=>({id:s.id,product_name:s.product_name,buyer_sku_code:s.buyer_sku_code,desc:s.desc||"",seller_product_status:s.seller_product_status?"1":"0",buyer_product_status:s.buyer_product_status?"1":"0",commission_sell_percentage:s.commission_sell_percentage||"",commission_sell_fixed:s.commission_sell_fixed||"",image:s.image||"",original:{desc:s.desc||"",seller_product_status:s.seller_product_status?"1":"0",buyer_product_status:s.buyer_product_status?"1":"0",commission_sell_percentage:s.commission_sell_percentage||"",commission_sell_fixed:s.commission_sell_fixed||"",image:s.image||""}}));u(t)},[c]);const r=t=>{const{name:s,value:a}=t.target;y(i=>({...i,[s]:a}))},n=(t,s,a)=>{u(i=>i.map(d=>d.id===t?{...d,[s]:a}:d))},j=()=>{confirm("Apakah Anda yakin ingin menerapkan nilai ini ke semua produk di halaman ini? Perubahan pada form di bawah akan ditimpa.")&&(u(t=>t.map(s=>{const a={...s};return l.desc.trim()!==""&&(a.desc=l.desc),l.seller_product_status!==""&&(a.seller_product_status=l.seller_product_status),l.buyer_product_status!==""&&(a.buyer_product_status=l.buyer_product_status),l.commission_sell_percentage!==""&&(a.commission_sell_percentage=l.commission_sell_percentage),l.commission_sell_fixed!==""&&(a.commission_sell_fixed=l.commission_sell_fixed),l.image.trim()!==""&&(a.image=l.image),a})),alert("Nilai dari form bulk telah diterapkan."))},b=t=>Object.keys(t.original).some(s=>t[s]!=t.original[s]),v=t=>{t.preventDefault();const s=h.filter(i=>b(i)).map(i=>{const d={};return Object.keys(i.original).forEach(o=>{i[o]!=i.original[o]&&(d[o]=i[o])}),d.seller_product_status!==void 0&&(d.seller_product_status=d.seller_product_status==="1"),d.buyer_product_status!==void 0&&(d.buyer_product_status=d.buyer_product_status==="1"),{id:i.id,updates:d}});if(s.length===0){alert("Tidak ada perubahan untuk disimpan.");return}const a=s.map(i=>i.id);k.post(route("postpaid.bulk-update"),{ids:a,individual_updates:s},{onStart:()=>g(!0),onFinish:()=>g(!1),onSuccess:()=>{},onError:i=>{console.error("Update failed:",i),alert("Gagal memperbarui produk. Silakan periksa pesan error.")},preserveScroll:!0})};return e.jsxs("div",{user:f.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Bulk Edit Postpaid Products"}),children:[e.jsx(N,{title:"Bulk Edit Postpaid Products"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[x.message&&e.jsx("div",{className:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4",role:"alert",children:e.jsx("p",{children:x.message})}),e.jsx("div",{className:"mb-4",children:e.jsx(w,{href:route("postpaid.index"),className:"inline-flex items-center px-4 py-2 bg-gray-200 border border-transparent rounded-md font-semibold text-xs text-gray-800 uppercase tracking-widest hover:bg-gray-300 transition",children:"← Kembali ke Daftar Produk"})}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Terapkan ke Semua"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("input",{name:"desc",type:"text",placeholder:"Deskripsi",onChange:r,className:"form-input rounded-md shadow-sm w-full"}),e.jsxs("select",{name:"seller_product_status",onChange:r,className:"form-select rounded-md shadow-sm w-full",children:[e.jsx("option",{value:"",children:"-- Status Penjual --"}),e.jsx("option",{value:"1",children:"Aktif"}),e.jsx("option",{value:"0",children:"Nonaktif"})]}),e.jsxs("select",{name:"buyer_product_status",onChange:r,className:"form-select rounded-md shadow-sm w-full",children:[e.jsx("option",{value:"",children:"-- Status Pembeli --"}),e.jsx("option",{value:"1",children:"Aktif"}),e.jsx("option",{value:"0",children:"Nonaktif"})]}),e.jsx("input",{name:"commission_sell_percentage",type:"number",placeholder:"Komisi %",onChange:r,className:"form-input rounded-md shadow-sm w-full"}),e.jsx("input",{name:"commission_sell_fixed",type:"number",placeholder:"Komisi Tetap",onChange:r,className:"form-input rounded-md shadow-sm w-full"}),e.jsx("input",{name:"image",type:"text",placeholder:"URL Gambar",onChange:r,className:"form-input rounded-md shadow-sm w-full"})]}),e.jsx("button",{type:"button",onClick:j,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-sm",children:"Terapkan"})]}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Komisi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gambar"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map((t,s)=>e.jsxs("tr",{className:b(t)?"bg-yellow-50":"",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.product_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.buyer_sku_code})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("textarea",{value:t.desc,onChange:a=>n(t.id,"desc",a.target.value),className:"form-textarea rounded-md shadow-sm w-full text-sm",rows:"3"}),p[`individual_updates.${s}.updates.desc`]&&e.jsx("div",{className:"text-red-500 text-xs mt-1",children:p[`individual_updates.${s}.updates.desc`]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("select",{value:t.seller_product_status,onChange:a=>n(t.id,"seller_product_status",a.target.value),className:"form-select rounded-md shadow-sm w-full text-sm mb-2",children:[e.jsx("option",{value:"1",children:"Seller Aktif"}),e.jsx("option",{value:"0",children:"Seller Nonaktif"})]}),e.jsxs("select",{value:t.buyer_product_status,onChange:a=>n(t.id,"buyer_product_status",a.target.value),className:"form-select rounded-md shadow-sm w-full text-sm",children:[e.jsx("option",{value:"1",children:"Buyer Aktif"}),e.jsx("option",{value:"0",children:"Buyer Nonaktif"})]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",max:"99",placeholder:"Komisi %",value:t.commission_sell_percentage,onChange:a=>n(t.id,"commission_sell_percentage",a.target.value),className:"form-input rounded-md shadow-sm w-full text-sm mb-2"}),e.jsx("input",{type:"number",min:"0",placeholder:"Komisi Tetap",value:t.commission_sell_fixed,onChange:a=>n(t.id,"commission_sell_fixed",a.target.value),className:"form-input rounded-md shadow-sm w-full text-sm"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",placeholder:"URL Gambar",value:t.image,onChange:a=>n(t.id,"image",a.target.value),className:"form-input rounded-md shadow-sm w-full text-sm"})})]},t.id))})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",disabled:_,children:_?"Menyimpan...":"Simpan Semua Perubahan"})})]})]})})]})}export{C as default};
