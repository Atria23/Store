import{q as C,r as a,j as e}from"./app-Cyp4GSPF.js";function O(){const{products:x}=C().props,[n,b]=a.useState(""),[s,d]=a.useState(null),[f,i]=a.useState(!1),[u,j]=a.useState(x),[c,N]=a.useState("asc"),[m,I]=a.useState({}),[p,E]=a.useState(""),[l,S]=a.useState(!1),[o,k]=a.useState(0),y=async()=>{try{const r=await(await fetch("/balance")).json();k(r.balance)}catch(t){console.error("Failed to fetch balance:",t)}};a.useEffect(()=>{y()},[]);const w=()=>{const t=[...u].sort((r,g)=>c==="asc"?parseInt(r.price)-parseInt(g.price):parseInt(g.price)-parseInt(r.price));j(t),N(c==="asc"?"desc":"asc")},v=t=>parseInt(t,10).toLocaleString("id-ID").replace(/,/g,"."),P=t=>{d(t),i(!0)},h=()=>{i(!1),d(null)},_=t=>{if(t.preventDefault(),!s||!n){alert("Mohon lengkapi nomor pelanggan dan pilih produk.");return}S(!0),fetch("/transactions",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({buyer_sku_code:s.buyer_sku_code,customer_no:n,price_product:s.price,testing:!1})}).then(r=>r.json()).then(r=>{console.log("Response:",r)}).catch(r=>{console.error("Error:",r)})};return e.jsxs("div",{className:"p-4",children:[p&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:p}),e.jsxs("div",{className:"text-lg mt-2",children:[e.jsx("strong",{children:"Saldo Anda:"})," Rp",o.toLocaleString("id-ID").replace(/,/g,".")]}),e.jsx("h1",{className:"text-2xl font-bold",children:"Daftar Produk Free Fire"}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:w,className:"bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600",children:["Sort Harga: ",c==="asc"?"Terendah":"Termahal"]})}),e.jsxs("div",{className:"my-4",children:[e.jsx("label",{htmlFor:"customerNo",className:"block text-sm font-medium text-gray-700",children:"Nomor Pelanggan"}),e.jsx("input",{type:"text",id:"customerNo",value:n,onChange:t=>b(t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Masukkan nomor pelanggan"}),m.customer_no&&e.jsx("p",{className:"text-red-500 text-sm",children:m.customer_no})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:u.map(t=>e.jsxs("div",{className:"border p-4 rounded shadow bg-white hover:shadow-md",children:[e.jsx("h2",{className:"font-semibold",children:t.product_name}),e.jsxs("p",{children:["Harga: Rp",v(t.price)]}),e.jsx("button",{onClick:()=>P(t),className:"mt-2 w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600",children:"Detail Produk"})]},t.buyer_sku_code))}),f&&s&&e.jsxs("div",{className:"fixed bottom-0 left-0 w-full bg-white border-t shadow-lg p-4",onClick:t=>{t.target===t.currentTarget&&h()},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:s.product_name}),e.jsx("button",{onClick:h,className:"text-red-500 font-bold",children:"Tutup"})]}),e.jsx("p",{className:"mt-2",children:s.desc}),e.jsx("p",{className:"text-red-500 mt-2",children:o<s.price&&"Saldo Anda tidak mencukupi untuk transaksi ini."}),e.jsx("div",{className:"flex justify-between mt-4",children:e.jsx("button",{onClick:_,disabled:l||s&&o<s.price,className:`bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 ${(l||s&&o<s.price)&&"bg-gray-400 cursor-not-allowed"}`,children:l?"Processing...":"Lanjutkan"})})]})]})}export{O as default};
